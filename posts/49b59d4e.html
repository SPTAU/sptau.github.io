<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic%7CLobster+Two:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CNoto+Sans:300,300italic,400,400italic,700,700italic%7CJetBrains+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.css" integrity="sha256-vQkngPS8jiHHH0I6ABTZroZk8NPZ7b+MUReOFE9UsXQ=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"sptau.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":true,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><meta name="description" content="é’ˆå¯¹ä¸Šä¸€æ¬¡ Titanic æ•°æ®äºŒåˆ†ç±»é¢„æµ‹å®éªŒçš„æ‹“å±•å’Œå»¶ä¼¸"><meta property="og:type" content="article"><meta property="og:title" content="PyTorch å®ç°åˆ†ç±»é—®é¢˜æ€»ç»“-ç»­"><meta property="og:url" content="http://sptau.github.io/posts/49b59d4e.html"><meta property="og:site_name" content="å·½ç¦»é˜"><meta property="og:description" content="é’ˆå¯¹ä¸Šä¸€æ¬¡ Titanic æ•°æ®äºŒåˆ†ç±»é¢„æµ‹å®éªŒçš„æ‹“å±•å’Œå»¶ä¼¸"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2022-09-12T11:58:44.000Z"><meta property="article:modified_time" content="2023-11-24T14:50:07.159Z"><meta property="article:author" content="SPTAU"><meta property="article:tag" content="CNN"><meta property="article:tag" content="Python"><meta property="article:tag" content="PyTorch"><meta name="twitter:card" content="summary"><link rel="canonical" href="http://sptau.github.io/posts/49b59d4e.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://sptau.github.io/posts/49b59d4e.html","path":"posts/49b59d4e.html","title":"PyTorch å®ç°åˆ†ç±»é—®é¢˜æ€»ç»“-ç»­"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>PyTorch å®ç°åˆ†ç±»é—®é¢˜æ€»ç»“-ç»­ | å·½ç¦»é˜</title><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style><link rel="alternate" href="/atom.xml" title="å·½ç¦»é˜" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">å·½ç¦»é˜</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">éç”Ÿæ¥å¯Œè´µ æ˜¯å¤©é“é…¬å‹¤</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="æœç´¢" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview">ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E5%9B%9E%E9%A1%BE"><span class="nav-text">é—®é¢˜å›é¡¾</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%8A%A0%E8%BD%BD-dataset"><span class="nav-text">å¤šçº¿ç¨‹åŠ è½½ Dataset</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"><span class="nav-text">è§£å†³æ–¹æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E7%BD%91%E9%A1%B5"><span class="nav-text">å‚è€ƒç½‘é¡µ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#k-%E6%8A%98%E4%BA%A4%E5%8F%89%E6%A0%A1%E9%AA%8C%E6%B3%95"><span class="nav-text">K æŠ˜äº¤å‰æ ¡éªŒæ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E7%BD%91%E9%A1%B5-1"><span class="nav-text">å‚è€ƒç½‘é¡µ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%92%E4%B8%80%E5%8C%96%E9%97%AE%E9%A2%98"><span class="nav-text">å½’ä¸€åŒ–é—®é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BD%92%E4%B8%80%E5%8C%96%E4%B8%8E%E5%88%92%E5%88%86%E8%AE%AD%E7%BB%83%E9%9B%86%E5%92%8C%E9%AA%8C%E8%AF%81%E9%9B%86%E9%A1%BA%E5%BA%8F%E9%97%AE%E9%A2%98"><span class="nav-text">å½’ä¸€åŒ–ä¸åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†é¡ºåºé—®é¢˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E7%BD%91%E9%A1%B5-2"><span class="nav-text">å‚è€ƒç½‘é¡µ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E4%BF%9D%E5%AD%98"><span class="nav-text">æ¨¡å‹ä¿å­˜</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9E%8B%E5%8F%82%E6%95%B0"><span class="nav-text">ä¿å­˜&#x2F;åŠ è½½æ¨¡å‹å‚æ•°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E5%8A%A0%E8%BD%BD%E6%95%B4%E4%B8%AA%E6%A8%A1%E5%9E%8B"><span class="nav-text">ä¿å­˜&#x2F;åŠ è½½æ•´ä¸ªæ¨¡å‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E7%BD%91%E9%A1%B5-3"><span class="nav-text">å‚è€ƒç½‘é¡µ</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="SPTAU" src="/images/avatar.png"><p class="site-author-name" itemprop="name">SPTAU</p><div class="site-description" itemprop="description">æ±Ÿæ¹–è¡Œèµ° åˆå¿ƒä¾æ—§ æ¥å¹´è¿˜ä¹¡ ä¸€æ¢¦åƒç§‹</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">4</span> <span class="site-state-item-name">åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">9</span> <span class="site-state-item-name">æ ‡ç­¾</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/SPTAU" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;SPTAU" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:sptau@qq.com" title="E-Mail â†’ mailto:sptau@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/1601578" title="Bilibili â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;1601578" rel="noopener me" target="_blank"><i class="fa-brands fa-bilibili fa-fw"></i>Bilibili</a></span></div></div></div></div><div class="sidebar-inner sidebar-blogroll"><div class="links-of-blogroll animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> é“¾æ¥</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://blinkfox.github.io/" title="https:&#x2F;&#x2F;blinkfox.github.io" rel="noopener" target="_blank">é—ªçƒä¹‹ç‹ - blinkfox</a></li><li class="links-of-blogroll-item"><a href="https://www.haomwei.com/" title="https:&#x2F;&#x2F;www.haomwei.com&#x2F;" rel="noopener" target="_blank">å± Â·åŸ - å± å¤«9441</a></li><li class="links-of-blogroll-item"><a href="http://yearito.cn/" title="http:&#x2F;&#x2F;yearito.cn&#x2F;" rel="noopener" target="_blank">Yearito's Blog - yearito</a></li><li class="links-of-blogroll-item"><a href="https://io-oi.me/" title="https:&#x2F;&#x2F;io-oi.me&#x2F;" rel="noopener" target="_blank">reuixiy's Blog - reuixiy</a></li><li class="links-of-blogroll-item"><a href="https://www.yuque.com/cbyd/chengbao" title="https:&#x2F;&#x2F;www.yuque.com&#x2F;cbyd&#x2F;chengbao" rel="noopener" target="_blank">åŸå ¡é˜…è¯»æ‚å¿— - å—ç™¾åŸ</a></li></ul></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://sptau.github.io/posts/49b59d4e.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="SPTAU"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="å·½ç¦»é˜"><meta itemprop="description" content="æ±Ÿæ¹–è¡Œèµ° åˆå¿ƒä¾æ—§ æ¥å¹´è¿˜ä¹¡ ä¸€æ¢¦åƒç§‹"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="PyTorch å®ç°åˆ†ç±»é—®é¢˜æ€»ç»“-ç»­ | å·½ç¦»é˜"><meta itemprop="description" content="é’ˆå¯¹ä¸Šä¸€æ¬¡ Titanic æ•°æ®äºŒåˆ†ç±»é¢„æµ‹å®éªŒçš„æ‹“å±•å’Œå»¶ä¼¸"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">PyTorch å®ç°åˆ†ç±»é—®é¢˜æ€»ç»“-ç»­</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2022-09-12 19:58:44" itemprop="dateCreated datePublished" datetime="2022-09-12T19:58:44+08:00">2022-09-12</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-11-24 22:50:07" itemprop="dateModified" datetime="2023-11-24T22:50:07+08:00">2023-11-24</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">æŠ€æœ¯</span></a> </span>ï¼Œ <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%8A%80%E6%9C%AF/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a> </span></span><span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-break"></span> <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>1.8k</span> </span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span>2 åˆ†é’Ÿ</span></span></div><div class="post-description">é’ˆå¯¹ä¸Šä¸€æ¬¡ Titanic æ•°æ®äºŒåˆ†ç±»é¢„æµ‹å®éªŒçš„æ‹“å±•å’Œå»¶ä¼¸</div></div></header><div class="post-body" itemprop="articleBody"><h2 id="é—®é¢˜å›é¡¾">é—®é¢˜å›é¡¾</h2><h3 id="å¤šçº¿ç¨‹åŠ è½½-dataset">å¤šçº¿ç¨‹åŠ è½½ Dataset</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dataset = TitanicDataset(<span class="string">"./dataset/titanic/processed_train.csv"</span>)</span><br><span class="line">train_loader = DataLoader(dataset=dataset, batch_size=<span class="number">32</span>, shuffle=<span class="literal">True</span>, num_workers=<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure><p>å…¶ä¸­å‚æ•° num_works è¡¨ç¤ºè½½å…¥æ•°æ®æ—¶ä½¿ç”¨çš„è¿›ç¨‹æ•°ï¼Œæ­¤æ—¶å¦‚æœå‚æ•°çš„å€¼ä¸ä¸º0è€Œä½¿ç”¨å¤šè¿›ç¨‹æ—¶ä¼šå‡ºç°æŠ¥é”™</p><blockquote><p>RuntimeError: An attempt has been made to start a new process before the current process has finished its bootstrapping phase. This probably means that you are not using fork to start your child processes and you have forgotten to use the proper idiom in the main module: if <code>__name__ == '__main__':</code> freeze_support() ... The "<code>freeze_support()</code>" line can be omitted if the program is not going to be frozen to produce an executable.</p></blockquote><h4 id="è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</h4><p>å½“å‚æ•° num_works ä¸ä¸º 0 æ—¶ï¼Œéœ€è¦åœ¨æ•°æ®è°ƒç”¨å‰ä¹‹å‰åŠ ä¸Š <code>if __name__ == '__main__':</code></p><h4 id="å‚è€ƒç½‘é¡µ">å‚è€ƒç½‘é¡µ</h4><p>diandianti - <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/4a1a92f0efd9">pytorch-Dataloaderå¤šè¿›ç¨‹ä½¿ç”¨å‡ºé”™</a></p><h3 id="k-æŠ˜äº¤å‰æ ¡éªŒæ³•">K æŠ˜äº¤å‰æ ¡éªŒæ³•</h3><p>K æŠ˜äº¤å‰æ ¡éªŒæ³•æ˜¯å°†è®­ç»ƒé›†åˆ’åˆ†ä¸º K ä»½å­æ•°æ®é›†ï¼Œç„¶åè¿›è¡Œ K è½®è®­ç»ƒï¼Œåœ¨ç¬¬ K è½®è®­ç»ƒæ—¶ï¼Œå°†ç¬¬ K ä»½å­æ•°æ®é›†ä½œä¸ºéªŒè¯é›†æ¥è¯„ä¼°è®­ç»ƒç»“æœï¼Œæœ€ç»ˆä¼šå¾—åˆ° K ä¸ªç»“æ„ç›¸åŒï¼Œå‚æ•°ä¸åŒçš„ç½‘ç»œï¼Œç„¶åå†ä»ä¸­é€‰æ‹©è¯„ä»·æœ€å¥½æ¨¡å‹</p><p>åœ¨å®é™…è®­ç»ƒä¸­å¯ä»¥å°†ä¸‹åˆ—ä»£ç åµŒå…¥è®­ç»ƒè¿‡ç¨‹ä¸­</p><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kfold = KFold(n_splits=k_folds, shuffle=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> fold, (train_ids, test_ids) <span class="keyword">in</span> <span class="built_in">enumerate</span>(kfold.split(train_dataset)):</span><br><span class="line">    train_subsampler = SubsetRandomSampler(train_ids)</span><br><span class="line">    train_loader = DataLoader(train_dataset, batch_size=batch_size, sampler=train_subsampler)</span><br><span class="line">    test_loader = DataLoader(train_dataset, batch_size=batch_size, sampler=test_subsampler)</span><br><span class="line">    <span class="comment"># training epoch</span></span><br></pre></td></tr></tbody></table></figure><p>ä½¿å¾—åœ¨æ¯ä¸€æŠ˜è®­ç»ƒæ—¶ï¼Œè®­ç»ƒé›†å’ŒéªŒè¯é›†èƒ½å¤Ÿå˜åŒ–</p><h4 id="å‚è€ƒç½‘é¡µ-1">å‚è€ƒç½‘é¡µ</h4><p>Jennie_J - <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43685844/article/details/88635492">sklearn KFold()</a></p><p>å¤–éƒ¨é€é¥ - <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/150446294">python sklearnä¸­KFoldä¸StratifiedKFold</a></p><p>christianversloot - <a target="_blank" rel="noopener" href="https://github.com/christianversloot/machine-learning-articles/blob/main/how-to-use-k-fold-cross-validation-with-pytorch.md">How to use K-fold Cross Validation with PyTorch?</a></p><h3 id="å½’ä¸€åŒ–é—®é¢˜">å½’ä¸€åŒ–é—®é¢˜</h3><h4 id="å½’ä¸€åŒ–ä¸åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†é¡ºåºé—®é¢˜">å½’ä¸€åŒ–ä¸åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†é¡ºåºé—®é¢˜</h4><p>åº”å½“å…ˆè¿›è¡Œè®­ç»ƒé›†åˆ’åˆ†å†è¿›è¡Œå½’ä¸€åŒ–</p><p>å› ä¸ºå½’ä¸€åŒ–å®é™…ä¸Šæ˜¯ä»æ•°æ®é›†ä¸­æå–ä¿¡æ¯ï¼Œè€Œç®—æ³•ä¸åº”çŸ¥é“æ¥è‡ªè®­ç»ƒé›†ä»¥å¤–ä¿¡æ¯ï¼Œå¦åˆ™ä¸€å®šç¨‹åº¦ä¸Šä¼šå¯¼è‡´æ ‡ç­¾æ³„æ¼ï¼Œé€ æˆè®­ç»ƒç»“æœå‡ºç°åå·®</p><h4 id="å‚è€ƒç½‘é¡µ-2">å‚è€ƒç½‘é¡µ</h4><p>PigOrz - <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33731081/article/details/103852478">ã€å…³äºå½’ä¸€åŒ–ä¸åå½’ä¸€åŒ–æ•°æ®ç»Ÿä¸€çš„é—®é¢˜ã€‘ï¼šè®­ç»ƒé›†ä¸æµ‹è¯•é›†å¿…é¡»ä½¿ç”¨åŒä¸€å‚æ•°çš„å½’ä¸€åŒ–ä¸åå½’ä¸€åŒ–</a></p><p>lizju - <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42227482/article/details/105829627">DataFrameçš„å½’ä¸€åŒ–</a></p><p>Shian150629 - <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43759518/article/details/113880715">æ ‡å‡†åŒ–ï¼Œå½’ä¸€åŒ–ä¸è®­ç»ƒ-æµ‹è¯•é›†æ•°æ®å¤„ç†</a></p><h3 id="æ¨¡å‹ä¿å­˜">æ¨¡å‹ä¿å­˜</h3><h4 id="ä¿å­˜åŠ è½½æ¨¡å‹å‚æ•°">ä¿å­˜/åŠ è½½æ¨¡å‹å‚æ•°</h4><ol type="1"><li><p>ä¿å­˜</p><p></p><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.save(model.state_dict(), PATH)</span><br></pre></td></tr></tbody></table></figure><p></p></li><li><p>åŠ è½½</p><p></p><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">model = TheModelClass(*args, **kwargs)</span><br><span class="line">model.load_state_dict(torch.load(PATH))</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br></pre></td></tr></tbody></table></figure><p></p></li></ol><h4 id="ä¿å­˜åŠ è½½æ•´ä¸ªæ¨¡å‹">ä¿å­˜/åŠ è½½æ•´ä¸ªæ¨¡å‹</h4><ol type="1"><li><p>ä¿å­˜</p><p></p><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.save(model, PATH)</span><br></pre></td></tr></tbody></table></figure><p></p></li><li><p>åŠ è½½</p><p></p><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Model class must be defined somewhere</span></span><br><span class="line">model = torch.load(PATH)</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br></pre></td></tr></tbody></table></figure><p></p></li></ol><h4 id="å‚è€ƒç½‘é¡µ-3">å‚è€ƒç½‘é¡µ</h4><p>çˆ±ä¸æŒä¹… - <a target="_blank" rel="noopener" href="https://blog.csdn.net/wacebb/article/details/108021921">Pytorchå¦‚ä½•ä¿å­˜å’ŒåŠ è½½æ¨¡å‹å‚æ•°</a></p><p>æœºå™¨å­¦ä¹ å…¥å‘è€… - <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/94971100">ä¸€æ–‡æ¢³ç†pytorchä¿å­˜å’Œé‡è½½æ¨¡å‹å‚æ•°æ”»ç•¥</a></p><p>PyTorch - <a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/beginner/saving_loading_models.html">SAVING AND LOADING MODELS</a></p></div><footer class="post-footer"><script src="//sdk.jinrishici.com/v2/browser/jinrishici.js"></script><script>jinrishici.load((result) => {
    let jrsc = document.getElementById('jrsc');
    const data = result.data;
    let author = data.origin.author;
    let title = 'ã€Š' + data.origin.title + 'ã€‹';
    let content = data.content.substr(0, data.content.length - 1);
    let dynasty = data.origin.dynasty.substr(0, data.origin.dynasty.length - 1);
    jrsc.innerText = content + ' @ ' + dynasty + 'Â·' + author + title;
  });</script><div style="text-align:center"><span id="jrsc">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯....</span></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>SPTAU</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="http://sptau.github.io/posts/49b59d4e.html" title="PyTorch å®ç°åˆ†ç±»é—®é¢˜æ€»ç»“-ç»­">http://sptau.github.io/posts/49b59d4e.html</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div><div class="post-tags"><a href="/tags/CNN/" rel="tag"><i class="fa fa-tag"></i> CNN</a> <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a> <a href="/tags/PyTorch/" rel="tag"><i class="fa fa-tag"></i> PyTorch</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/7efb9c78.html" rel="prev" title="PyTorch å®ç°å¤šåˆ†ç±»ä»»åŠ¡æ€»ç»“"><i class="fa fa-angle-left"></i> PyTorch å®ç°å¤šåˆ†ç±»ä»»åŠ¡æ€»ç»“</a></div><div class="post-nav-item"><a href="/posts/3cbaf5b4.html" rel="next" title="PyTorch æ­å»º AlexNet æ¨¡å‹å¯¹ CIFAR10 æ•°æ®é›†åˆ†ç±»æ€»ç»“">PyTorch æ­å»º AlexNet æ¨¡å‹å¯¹ CIFAR10 æ•°æ®é›†åˆ†ç±»æ€»ç»“ <i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2022 â€“ <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">SPTAU</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="ç«™ç‚¹æ€»å­—æ•°">86k</span></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="æ€»è®¿å®¢é‡"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="æ€»è®¿é—®é‡"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨</div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><a role="button" class="book-mark-link book-mark-link-fixed"></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.umd.js" integrity="sha256-oyhjPiYRWGXaAt+ny/mTMWOnN1GBoZDUQnzzgC7FRI4=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"neutral","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.5.0/mermaid.min.js","integrity":"sha256-K7oJiQlDulzl24ZUFOywuYme1JqBBvQzK6m8qHjt9Gk="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script src="/js/third-party/fancybox.js"></script><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/js/third-party/math/mathjax.js"></script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options = {
  bottom: '32px',
  right: '32px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous"><script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"SPTAU","repo":"SPTAU.github.io","client_id":"88f04708a8ad279abe57","client_secret":"f9f4099eb59d8ab8522197e56437b52ad9048c0e","admin_user":"SPTAU","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"b26594663c31f1d6be89470939cbbf56"}</script><script src="/js/third-party/comments/gitalk.js"></script><script src="//cdn.jsdelivr.net/npm/js-base64/base64.min.js"></script><script>const hasAttr = (e,a) => a.some(_=> e.attr(_)!==undefined);
        $('a').each(function() {
          const $this = $(this);
          if(hasAttr($this,["data-fancybox","ignore-external-link"])) return;
          const href = $this.attr('href');
          if (href && href.match('^((http|https|thunder|qqdl|ed2k|Flashget|qbrowser|ftp|rtsp|mms)://)')) {
            const strs = href.split('/');
            if (strs.length >= 3) {
                const host = strs[2];
                if (host !== 'SPTAU.github.io' || window.location.host) {
                    $this.attr('href', '/go.html?u='+href+'').attr('rel', 'external nofollow noopener noreferrer');
                    if (true) {
                        $this.attr('target', '_blank');
                    }
                }
            }
          }
        });</script></body></html>